% skewu.m:     calculate the "skewness" of saccades% written by:  Jonathan Jacobs%              January 1997 - December 2000 (last mod: 12/21/00)% we will go through the control point lists, a column at% a time, extracting the real points from the NaNs. % The stripped column is then used to index into the proper% column of the position data array.  The points are concatenated% into vectors (love that transpose operator) and displayed.%clear all_sacv_on_pts  all_sacp_on_pts %clear all_sacv_off_pts all_sacp_off_pts %clear all_cycle_beg_pts all_cycle_end_pts all_max_v_pts %clear sacp_dur_list sacv_dur_list sacp_ampl_list%clear sacv1_ampl_list sacv2_ampl_list max_vel_list%clear time2peak_p_list time2peak_v_list skew_list_p skew_list_vall_sacv_on_pts=[];   all_sacp_on_pts=[];all_sacv_off_pts=[];  all_sacp_off_pts=[];all_cycle_beg_pts=[]; all_cycle_end_pts=[]; all_max_v_pts=[]; sacp_dur_list=[];     sacv_dur_list=[];     sacp_ampl_list=[];sacv1_ampl_list=[];   sacv2_ampl_list=[];   max_vel_list=[];time2peak_p_list=[];  time2peak_v_list=[];  skew_list_p=[]; skew_list_v=[];if ~exist( 'sacp_on_mat')   disp( 'You need to run "pickdata" first.' )   returnend[nRows, nCols] = size( sacv_on_mat );for z = 1:nCols   % whack out the 'NaNs'   num_pts = length( find( sacp_on_mat(:,z) < 100000 ) );   num_pts_list(z) = num_pts;   % concatenate the lists of saccade control points   this_sacv_on     = sacv_on_mat( 1:num_pts,z );   all_sacv_on_pts  = [all_sacv_on_pts' this_sacv_on']';   this_sacp_on     = sacp_on_mat( 1:num_pts,z );   all_sacp_on_pts  = [all_sacp_on_pts; this_sacp_on];   this_sacv_off    = sacv_off_mat( 1:num_pts,z );   all_sacv_off_pts = [all_sacv_off_pts; this_sacv_off];   this_sacp_off    = sacp_off_mat( 1:num_pts,z );   all_sacp_off_pts = [all_sacp_off_pts; this_sacp_off];   this_max_v_pt    = max_v_pt_mat( 1:num_pts,z );   all_max_v_pts    = [all_max_v_pts; this_max_v_pt];   this_max_vel = abs( vel(this_sacv_on,z) - vel(this_max_v_pt,z) );   max_vel_list = [max_vel_list' this_max_vel']';   this_sacp_ampl  = abs( pos(this_sacp_off,z)-pos(this_sacp_on,z) );   this_sacv1_ampl = this_sacp_ampl +...                     (abs(pos(this_sacv_on,z) -pos(this_sacp_on,z)));   this_sacv2_ampl = this_sacv1_ampl +...                     (abs(pos(this_sacv_off,z)-pos(this_sacp_off,z)));   sacp_ampl_list  = [sacp_ampl_list' this_sacp_ampl']';   sacv1_ampl_list = [sacv1_ampl_list' this_sacv1_ampl']';   sacv2_ampl_list = [sacv2_ampl_list' this_sacv2_ampl']';   this_sacp_dur = 1000*(this_sacp_off - this_sacp_on)/samp_f_mat(z);   this_sacv_dur = 1000*(this_sacv_off - this_sacv_on)/samp_f_mat(z);   sacp_dur_list = [sacp_dur_list' this_sacp_dur']';   sacv_dur_list = [sacv_dur_list' this_sacv_dur']';   this_time2peak_p = 1000*(this_max_v_pt - this_sacp_on)/samp_f_mat(z);   this_time2peak_v = 1000*(this_max_v_pt - this_sacv_on)/samp_f_mat(z);   time2peak_p_list = [time2peak_p_list' this_time2peak_p']';   time2peak_v_list = [time2peak_v_list' this_time2peak_v']';   this_skewness_v = this_time2peak_v ./ this_sacv_dur;   skew_list_v = [skew_list_v' this_skewness_v']';   this_skewness_p = this_time2peak_p ./ this_sacp_dur;   skew_list_p = [skew_list_p' this_skewness_p']';end %for zVxD  = max_vel_list .* sacp_ampl_list;VxD1 = max_vel_list .* sacv1_ampl_list;VxD2 = max_vel_list .* sacv2_ampl_list;% useful statisticstotal_num = length(skew_list_p);disp( ['Total number of saccades: ' num2str(total_num)] );disp( ' ' )disp( ['Max saccade v-duration: ' num2str(max(sacv_dur_list)) ' msec'] );disp( ['Min saccade v-duration: ' num2str(min(sacv_dur_list)) ' msec'] );disp( ['Max saccade v1-amplitude: ' num2str(max(sacv1_ampl_list)) ' deg'] );disp( ['Min saccade v1-amplitude: ' num2str(min(sacv1_ampl_list)) ' deg'] );disp( ['Max saccade v2-amplitude: ' num2str(max(sacv2_ampl_list)) ' deg'] );disp( ['Min saccade v2-amplitude: ' num2str(min(sacv2_ampl_list)) ' deg'] );disp( ' ' )disp( ['Max saccade p-duration: ' num2str(max(sacp_dur_list)) ' msec'] );disp( ['Min saccade p-duration: ' num2str(min(sacp_dur_list)) ' msec'] );disp( ['Max saccade p-amplitude: ' num2str(max(sacp_ampl_list)) ' deg'] );disp( ['Min saccade p-amplitude: ' num2str(min(sacp_ampl_list)) ' deg'] );disp( ' ' )disp( ['Max skewness (v_points): ' num2str(max(skew_list_v))] );disp( ['Min skewness (v_points): ' num2str(min(skew_list_v))] );disp( ['Avg skewness (v_points): ' num2str(mean(skew_list_v))] );disp( ' ' )disp( ['Max skewness (p_points): ' num2str(max(skew_list_p))] );disp( ['Min skewness (p_points): ' num2str(min(skew_list_p))] );disp( ['Avg skewness (p_points): ' num2str(mean(skew_list_p))] );disp( ' ' )% now let's make a lot of plots...[num, width] = size(what_files);fileStr   = [num2str(num) ' files loaded.'];nSacStr   = [num2str(total_num) ' saccades.'];%% S-D: 1stfigure('Name','Skewness vs Duration',...       'NumberTitle','off');subplot(2,2,1)plot(sacp_dur_list, skew_list_v, 'g.');xlabel('Sacc. Dur. (msec) [p-timing]')ylabel('Skewness [v-timing]')top = line([20 120 NaN 20 120],[0.8 0.3 NaN 0.6 0.125]);axis([0 140 0 1]);set(top,'Color','w');set(top,'LineStyle','--');orient portrait%title( ['Skewness:  ' fileStr '  ' nSacStr] )title( ['Skewness:  ' nSacStr] )%% S-D: 2nd%figure('Name','Skewness vs Duration (v-timing)',...%       'NumberTitle','off');subplot(2,2,2)plot(sacv_dur_list, skew_list_v, 'g.');xlabel('Sacc. Dur. (msec) [v-timing]')ylabel('Skewness [v-timing]')top = line([20 120 NaN 20 120],[0.8 0.3 NaN 0.6 0.125]);axis([0 140 0 1]);set(top,'Color','w');set(top,'LineStyle','--');orient portrait%title( ['Skewness:  ' fileStr '  ' nSacStr] )%% S-D: 3rd%figure('Name','Skewness vs Duration (p-timing)',...%       'NumberTitle','off');subplot(2,2,3)plot(sacp_dur_list, skew_list_p, 'g.');xlabel('Sacc. Dur. (msec) [p-timing]')ylabel('Skewness [p-timing]')top = line([20 120 NaN 20 120],[0.8 0.3 NaN 0.6 0.125]);axis([0 140 0 1]);set(top,'Color','w');set(top,'LineStyle','--');orient portrait%title( ['Skewness:  ' fileStr '  ' nSacStr] )%% S-D: 4th%figure('Name','Skewness vs Duration (v-timing)',...%       'NumberTitle','off');subplot(2,2,4)plot(sacv_dur_list, skew_list_p, 'g.');xlabel('Sacc. Dur. (msec) [v-timing]')ylabel('Skewness [p-timing]')top = line([20 120 NaN 20 120],[0.8 0.3 NaN 0.6 0.125]);axis([0 140 0 1]);set(top,'Color','w');set(top,'LineStyle','--');orient portrait%title( ['Skewness:  ' fileStr '  ' nSacStr] )%% S-A: 1st%figure('Name','Skewness vs Amplitude (p-mag)',...%       'NumberTitle','off');%plot(sacp_ampl_list, skew_list_v, 'g.');%xlabel('Saccade Magnitude (deg) [unmod]')%ylabel('Acceleration Fraction [v-timing]')%orient landscape%title( ['Skewness:  ' fileStr '  ' nSacStr] )%% S-A: 2nd%figure('Name','Skewness vs Amplitude (v1-mag)',...%       'NumberTitle','off');%plot(sacv1_ampl_list, skew_list_v, 'g.');%xlabel('Saccade Magnitude (deg) [v1 mod]')%ylabel('Acceleration Fraction [v-timing]')%orient landscape%title( ['Skewness:  ' fileStr '  ' nSacStr] )%% S-A: 3rd%figure('Name','Skewness vs Amplitude (v2-mag)',...%       'NumberTitle','off');%plot(sacv2_ampl_list, skew_list_v, 'g.');%xlabel('Saccade Magnitude (deg) [v2 mod]')%ylabel('Acceleration Fraction [v-timing]')%orient landscape%title( ['Skewness:  ' fileStr '  ' nSacStr] )%% plot the skewness as histograms %%figure('Name','Skewness distribution',...       'NumberTitle','off');subplot(2,1,1)[binV, occurV] = hist( skew_list_v, 100);bar(occurV, binV);xlabel('Skewness [v-timing]')ylabel('Number of occurrences')orient portrait%title( ['Skewness (v-timing):  ' fileStr '  ' nSacStr] )title( ['Skewness (v-timing):  ' nSacStr] )%figure('Name','Skewness distribution (p-timing)',...%       'NumberTitle','off');subplot(2,1,2)[binP, occurP] = hist( skew_list_p, 100);bar(occurP, binP);xlabel('Skewness [p-timing]')ylabel('Number of occurrences')orient portrait%title( 'Skewness (p-timing)' )if ~exist( 'export' ) export = 0; endif export   expdir   clear histo SvsD   histo(:,1) = occurP';   histo(:,2) = binP';   histo(:,3) = occurV';   histo(:,4) = binV';   SvsD(:,1) = sacv_dur_list;   SvsD(:,2) = sacp_dur_list;   SvsD(:,3) = skew_list_v;   SvsD(:,4) = skew_list_p;      save pvhistos.txt histo -ascii   save SvsD.txt SvsD -ascii   omdirendif ~exist('debugme') debugme = 0; endif ~debugme   clear nRows nCols num_pts z num width   clear this_sacv_on this_sacv_off this_sacp_on this_sacp_off   clear this_sacp_ampl this_sacv_ampl   clear this_cycle_beg this_cycle_end   clear this_time2peak_p this_time2peak_v    clear this_skewness_p this_skewness_v skew_list_p skew_list_v   clear sacv_dur_list sacp_dur_list   clear time2peak_p_list time2peak_v_list   clear sacp_dur_list sacv_dur_list   clear sacp_ampl_list sacv1_ampl_list sacv2_ampl_list    clear all_sacv_on_pts  all_sacp_on_pts    clear all_sacv_off_pts all_sacp_off_pts    clear all_cycle_beg_pts all_cycle_end_pts    clear sac_dist init_sac_vel pre_sac_vel post_sac_vel vel_diff   clear this_max_vel max_vel_list   clear fileStr nSacStr histo   clear Vxd VxD1 VxD2 pvhisto SvsDend