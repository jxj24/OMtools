function [Rsq] = rsqr(y,ypred)[r1,c1]=size(y);[r2,c2]=size(ypred);if r1 ~= r2   if r1==c2 && r2==c1      ypred=ypred';   else      disp('Mismatched input vector lengths. Aborted')      return   endendy(isnan(y))=mean(y(~isnan(y)));dev = y - mean(y);          % deviations - measure of spreadSST = sum(dev.^2);          % total variation to be accounted forresid = y - ypred;          % residuals - measure of mismatchSSE = sum(resid.^2);        % variation NOT accounted forRsq = 1 - SSE/SST;          % percent of error explained